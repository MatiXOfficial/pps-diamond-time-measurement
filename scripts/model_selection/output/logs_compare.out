 gcccore/10.2.0 loaded.
 zlib/1.2.11-gcccore-10.2.0 loaded.
 binutils/2.35-gcccore-10.2.0 loaded.
 gcc/10.2.0 loaded.
 cudacore/11.1.1 loaded.
 cuda/11.1.1-gcc-10.2.0 loaded.
 gcccuda/2020b loaded.
 numactl/2.0.13-gcccore-10.2.0 loaded.
 xz/5.2.5-gcccore-10.2.0 loaded.
 libxml2/2.9.10-gcccore-10.2.0 loaded.
 libpciaccess/0.16-gcccore-10.2.0 loaded.
 hwloc/2.2.0-gcccore-10.2.0 loaded.
 libevent/2.1.12-gcccore-10.2.0 loaded.
 check/0.15.2-gcccore-10.2.0 loaded.
 gdrcopy/2.1-gcccore-10.2.0-cuda-11.1.1 loaded.
 ucx/1.9.0-gcccore-10.2.0-cuda-11.1.1 loaded.
 libfabric/1.11.0-gcccore-10.2.0 loaded.
 pmix/3.1.5-gcccore-10.2.0 loaded.
 openmpi/4.0.5-gcccuda-2020b loaded.
 openblas/0.3.12-gcc-10.2.0 loaded.
 gompic/2020b loaded.
 fftw/3.3.8-gompic-2020b loaded.
 scalapack/2.1.0-gompic-2020b loaded.
 fosscuda/2020b loaded.
 cudnn/8.1.0.77-cuda-11.1.1 loaded.
 nccl/2.8.3-gcccore-10.2.0-cuda-11.1.1 loaded.
 bzip2/1.0.8-gcccore-10.2.0 loaded.
 ncurses/6.2-gcccore-10.2.0 loaded.
 libreadline/8.0-gcccore-10.2.0 loaded.
 tcl/8.6.10-gcccore-10.2.0 loaded.
 sqlite/3.33.0-gcccore-10.2.0 loaded.
 gmp/6.2.0-gcccore-10.2.0 loaded.
 libffi/3.3-gcccore-10.2.0 loaded.
 python/3.8.6-gcccore-10.2.0 loaded.
 pybind11/2.6.0-gcccore-10.2.0 loaded.
 scipy-bundle/2020.11-fosscuda-2020b loaded.
 szip/2.1.1-gcccore-10.2.0 loaded.
 hdf5/1.10.7-gompic-2020b loaded.
 h5py/3.1.0-fosscuda-2020b loaded.
 curl/7.72.0-gcccore-10.2.0 loaded.
 double-conversion/3.1.5-gcccore-10.2.0 loaded.
 flatbuffers/1.12.0-gcccore-10.2.0 loaded.
 giflib/5.2.1-gcccore-10.2.0 loaded.
 icu/67.1-gcccore-10.2.0 loaded.
 jsoncpp/1.9.4-gcccore-10.2.0 loaded.
 nasm/2.15.05-gcccore-10.2.0 loaded.
 libjpeg-turbo/2.0.5-gcccore-10.2.0 loaded.
 lmdb/0.9.24-gcccore-10.2.0 loaded.
 nsync/1.24.0-gcccore-10.2.0 loaded.
 pcre/8.44-gcccore-10.2.0 loaded.
 protobuf/3.14.0-gcccore-10.2.0 loaded.
 protobuf-python/3.14.0-gcccore-10.2.0 loaded.
 flatbuffers-python/1.12-gcccore-10.2.0 loaded.
 typing-extensions/3.7.4.3-gcccore-10.2.0 loaded.
 libpng/1.6.37-gcccore-10.2.0 loaded.
 snappy/1.1.8-gcccore-10.2.0 loaded.
 tensorflow/2.8.0-fosscuda-2020b loaded.
2023-04-07 11:51:29.009794: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-04-07 11:51:29.642542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 30989 MB memory:  -> device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:df:00.0, compute capability: 7.0
2023-04-07 11:58:18.784983: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8100
/net/people/plgrid/plgkocotm/cern_test_beam_ml/pps-diamond-time-measurement/venv/lib/python3.8/site-packages/statsmodels/stats/weightstats.py:196: RuntimeWarning: invalid value encountered in sqrt
  return np.sqrt(self.var)
/net/software/testing/software/SciPy-bundle/2020.11-fosscuda-2020b/lib/python3.8/site-packages/scipy/optimize/minpack.py:828: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
Setup...
PWD: .
PWD_TMP: /net/ascratch/people/plgkocotm/pps-diamond-time-measurement
Loading dataset...
(19594, 64) (19594,)
Preprocessing...
(15675, 48) (15675,)
(15675, 48)
Regular models...
========== Model: mlp ==========
Number of parameters: 2737
Got score: 62.2520 (61.8898, 63.5250, 61.3414)
Got score: 64.1638 (64.3552, 64.0708, 64.0654)
Got score: 64.0925 (64.1858, 64.6720, 63.4197)
Got score: 64.3232 (63.0456, 65.9665, 63.9574)
Got score: 64.6807 (64.4985, 65.6295, 63.9141)
========== Model: convnet ==========
Number of parameters: 36865
Got score: 60.2729 (61.0052, 60.3887, 59.4249)
Got score: 62.8860 (63.3472, 62.3878, 62.9230)
Got score: 63.4463 (64.1480, 62.3253, 63.8655)
Got score: 64.1510 (65.6979, 61.7084, 65.0468)
Got score: 63.3919 (62.7827, 63.2426, 64.1504)
Heatmap models...
========== Model: unet ==========
Number of parameters: 456965
Got score: 58.4670 (58.5133, 58.4867, 58.4010)
Got score: 61.3665 (61.1652, 61.3238, 61.6105)
Got score: 61.2299 (61.1195, 61.1481, 61.4221)
Got score: 60.5852 (60.9375, 60.5477, 60.2705)
Got score: 61.8857 (62.3317, 61.4993, 61.8260)
Comparison...
          mean   std  n_params
Model                         
mlp      63.90  0.85      2737
convnet  62.83  1.34     36865
unet     60.71  1.19    456965
Elapsed 4976.120518875 seconds
